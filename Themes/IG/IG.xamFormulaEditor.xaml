<ResourceDictionary   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	                  xmlns:ig="http://schemas.infragistics.com/xaml"
	                  xmlns:igPrim="http://schemas.infragistics.com/xaml/primitives"
	                  xmlns:sys="clr-namespace:System;assembly=mscorlib"
                      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d"
	                  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

	<!-- *********************************  RESOURCES  ********************************* -->
    <ResourceDictionary.MergedDictionaries>     
        <ResourceDictionary Source="IG.Styles.xaml" />
        <ResourceDictionary Source="IG.xamDataTree.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <!-- ********************************** COLORS **********************************-->
    <Color x:Key="Color_1041">#FFFFCCCC</Color>

    <!-- ********************************** BRUSHES **********************************-->
    <!-- ContextualHelp Brushes -->		
    <LinearGradientBrush x:Key="ContextualHelpBackgroundBrush"  StartPoint="0,0" EndPoint="0,1">
        <GradientStop Offset="0" Color="{StaticResource Color_011}" />
        <GradientStop Offset="1" Color="{StaticResource Color_009}" />
    </LinearGradientBrush>
    <SolidColorBrush x:Key="ContextualHelpBorderBrush" Color="{StaticResource Color_008}"/>

	<!-- FormulaEditor Brushes -->
    <SolidColorBrush x:Key="FunctionGlyphBackgroundBrush" Color="{StaticResource Color_011}" />

    <SolidColorBrush x:Key="FormulaEditorBackgroundBrush" Color="{StaticResource Color_021}"/>
    <SolidColorBrush x:Key="FormulaEditorBorderBrush" Color="{StaticResource Color_021}"/>	

    <SolidColorBrush x:Key="FormulaEditorDialogBackgroundBrush" Color="{StaticResource Color_009}" />

    <LinearGradientBrush x:Key="HeaderTitleBackgroundBrush" StartPoint="0,0" EndPoint="0,0.97">
        <GradientStop Offset="0" Color="{StaticResource Color_005}" />
        <GradientStop Offset="0.93" Color="{StaticResource Color_003}" />
        <GradientStop Offset="0.98" Color="{StaticResource Color_003}" />
    </LinearGradientBrush>
    <SolidColorBrush x:Key="HeaderTitleBorderBrush" Color="{StaticResource Color_006}"/>

    <SolidColorBrush x:Key="EditorAreaBackgroundBrush" Color="{StaticResource Color_011}"/>
    <SolidColorBrush x:Key="EditorAreaBorderBrush" Color="{StaticResource Color_006}" />

    <SolidColorBrush x:Key="OperandsForegroundBrush" Color="{StaticResource Color_005}"/>
	
    <SolidColorBrush x:Key="DescriptionBackgroundBrush" Color="{StaticResource Color_008}"/>
    <SolidColorBrush x:Key="DescriptionBorderBrush" Color="{StaticResource Color_006}" />
	
    <SolidColorBrush x:Key="SyntaxEditorValidationErrorBrush" Color="{StaticResource Color_020}" igPrim:XamlHelper.IsExcludedFromWash="True"/>
    <SolidColorBrush x:Key="SyntaxErrorBackgroundBrush" Color="{StaticResource Color_1041}" igPrim:XamlHelper.IsExcludedFromWash="True"/>

    <SolidColorBrush x:Key="UndoRedoGlyphBrush" Color="{StaticResource Color_011}"/>
    <SolidColorBrush x:Key="UndoRedoShadowGlyphBrush" Color="{StaticResource Color_000}" />

    <!-- *********************************  SimpleScrollViewer Style  ********************************* -->
    <Style x:Key="SimpleScrollViewerStyle" TargetType="ScrollViewer">
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="BorderBrush" Value="{x:Null}" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="Margin" Value="0" />
    </Style>

    <!-- *********************************  FormulaEditorTextBox Style  ********************************* -->
    <Style x:Key="FormulaEditorTextBoxStyle" TargetType="igPrim:FormulaEditorTextBox">
        <Style.Resources>
            <Style TargetType="{x:Type FlowDocument}">
                <Setter Property="OverridesDefaultStyle" Value="true" />
            </Style>
        </Style.Resources>
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="{x:Null}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="KeyboardNavigation.TabNavigation" Value="None" />
        <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="igPrim:FormulaEditorTextBox">
                    <Border BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Background="{TemplateBinding Background}"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="True">
                        <ScrollViewer x:Name="PART_ContentHost"
                                      Style="{StaticResource SimpleScrollViewerStyle}"
                                      Focusable="False"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

	<Thickness x:Key="OperandsButtonGroupMargin">11,0,1,0</Thickness>	
	
    <!-- ********************************** ValueConverters **********************************-->
    <igPrim:ValueConverterGroup x:Key="boolToVisibility">
        <!-- if true sets visibility to Visible -->
        <igPrim:FixedValueConverter>
            <igPrim:FixedValueConverter.SourceValue>
                <sys:Boolean>True</sys:Boolean>
            </igPrim:FixedValueConverter.SourceValue>
            <igPrim:FixedValueConverter.DestinationValue>
                <Visibility>Visible</Visibility>
            </igPrim:FixedValueConverter.DestinationValue>
        </igPrim:FixedValueConverter>

        <!-- if false sets visibility to Collapsed -->
        <igPrim:FixedValueConverter>
            <igPrim:FixedValueConverter.DestinationValue>
                <Visibility>Collapsed</Visibility>
            </igPrim:FixedValueConverter.DestinationValue>
        </igPrim:FixedValueConverter>
    </igPrim:ValueConverterGroup>
  
    <igPrim:InverseBooleanConverter x:Key="inverseBoolean" />

    <!-- *********************************  TextBlock Style  ********************************* -->
    <Style x:Key="LabelsStyle" TargetType="TextBlock">
      <Setter Property="Foreground" Value="{StaticResource ThemeLightForegroundBrush}"/>
      <Setter Property="FontSize" Value="12"/>
      <Setter Property="FontFamily" Value="Segoe UI"/>
      <Setter Property="Margin" Value="5,0,0,0"/>
      <Setter Property="HorizontalAlignment" Value="Left"/>
      <Setter Property="VerticalAlignment" Value="Center"/>
    </Style>
			
     <!-- *********************************  ContextualHelpHost Style  ********************************* -->	
    <Style x:Key="ContextualHelpHostStyle" TargetType="igPrim:ContextualHelpHost">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="igPrim:ContextualHelpHost">
                    <Canvas Name="PART_RootCanvas">
                        <Canvas.Resources>
                            <Style TargetType="Border">
                                <Setter Property="Background" Value="{StaticResource ContextualHelpBackgroundBrush}"/>
                                <Setter Property="BorderBrush" Value="{StaticResource ContextualHelpBorderBrush}" />
                                <Setter Property="BorderThickness" Value="1" />
                                <Setter Property="CornerRadius" Value="3" />
                                <Setter Property="IsHitTestVisible" Value="False" />
                                <Setter Property="Padding" Value="5" />
                            </Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextWrapping" Value="Wrap" />
                            </Style>
                        </Canvas.Resources>
                        <Popup Name="PART_AutoCompleteListPopup">
                            <igPrim:AutoCompleteList Name="PART_AutoCompleteList"
			    				                    MinWidth="100"
                                                     SelectionMode="Single"
                                                     ItemContainerStyle="{StaticResource ListBoxItemStyle}" 
                                                     Style="{StaticResource ListBoxStyle}">
                                <igPrim:AutoCompleteList.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <igPrim:AutoCompleteListStackPanel/>
                                    </ItemsPanelTemplate>
                                </igPrim:AutoCompleteList.ItemsPanel>
                                <igPrim:AutoCompleteList.ItemTemplate>
                                    <DataTemplate>
                                        <igPrim:FormulaElementContentControl Content="{Binding}">
                                            <ig:Commanding.Command>
                                                <igPrim:FormulaEditorCommandSource EventName="MouseDoubleClick"
						                                                           CommandType="AutoCompleteItem"
                                                                                   ParameterBinding="{Binding}"/>
                                            </ig:Commanding.Command>
                                        </igPrim:FormulaElementContentControl>
                                    </DataTemplate>
                                </igPrim:AutoCompleteList.ItemTemplate>
                            </igPrim:AutoCompleteList>
                        </Popup>
                        <Popup Name="PART_AutoCompleteItemHelpPopup">
                            <Border MaxWidth="485">
                                <TextBlock Name="PART_AutoCompleteItemHelp" />
                            </Border>
                        </Popup>
                        <Popup Name="PART_FunctionSignatureHelpPopup">
                            <Border MaxWidth="600" >
                                <TextBlock Name="PART_FunctionSignatureHelp" />
                            </Border>
                        </Popup>
                        <Popup Name="PART_MouseOverHelpPopup">
                            <Border MaxWidth="600">
                                <TextBlock Name="PART_MouseOverHelp" />
                            </Border>
                        </Popup>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="igPrim:ContextualHelpHost" BasedOn="{StaticResource ContextualHelpHostStyle}" />

    <!-- *********************************  TransparentBackgroundButton Style  ********************************* -->
    <Style x:Key="TransparentBackgroundButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="{StaticResource TransparentBrush}"/>
        <Setter Property="BorderBrush" Value="{StaticResource TransparentBrush}"/>		
        <Setter Property="Foreground" Value="{StaticResource ThemeForegroundBrush}"/>
        <Setter Property="Padding" Value="3"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver"/>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0.867"
					                                     Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
					                                     Storyboard.TargetName="contentPresenter" d:IsOptimized="True"/>
                                        <DoubleAnimation Duration="0" To="0.867"
					                                     Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
					                                     Storyboard.TargetName="contentPresenter" d:IsOptimized="True"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0.4"
					                                     Storyboard.TargetProperty="(UIElement.Opacity)"
					                                     Storyboard.TargetName="contentPresenter" d:IsOptimized="True"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused"/>
                                <VisualState x:Name="Unfocused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Border x:Name="Background"
								Background="{TemplateBinding Background}" 
			                    BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="{TemplateBinding BorderBrush}">
                            <ContentPresenter x:Name="contentPresenter" 
			                                ContentTemplate="{TemplateBinding ContentTemplate}"
			                                Content="{TemplateBinding Content}"
			                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
			                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
			                                RenderTransformOrigin="0.5,0.5">
                            <ContentPresenter.RenderTransform>
                                <ScaleTransform/>
                            </ContentPresenter.RenderTransform>
                        </ContentPresenter>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- *********************************  OperatorsButton Style  ********************************* -->
    <Style x:Key="OperatorsButtonStyle" TargetType="Button" BasedOn="{StaticResource ButtonStyle}">
        <Setter Property="Foreground" Value="{StaticResource ThemeLightForegroundBrush}"/>
        <Setter Property="FontSize" Value="13.333"/>
        <Setter Property="Margin" Value="2,0,0,0" />
        <Setter Property="MinWidth" Value="22" />
        <Setter Property="Height" Value="22"/>
        <Setter Property="Command">
            <Setter.Value>
                <igPrim:InsertOperatorCommand />
            </Setter.Value>
        </Setter>
    </Style>										

    <!-- *********************************  FormulaEditorDialog Style  ********************************* -->
    <Style x:Key="FormulaEditorDialogStyle" TargetType="ig:FormulaEditorDialog">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ig:FormulaEditorDialog">
                    <Grid>
                        <Grid.Resources>
                            <Style TargetType="ScrollBar" BasedOn="{StaticResource ScrollbarStyle}" />
                            <Style TargetType="ig:XamDataTree">
                                <Setter Property="BorderThickness" Value="0" />
                            </Style>
                        </Grid.Resources>
                        <Grid.Background>
                            <StaticResource ResourceKey="FormulaEditorDialogBackgroundBrush"/>
                        </Grid.Background>

                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <ColorAnimation Duration="0" To="{StaticResource Color_005}"
                                                        Storyboard.TargetProperty="(Foreground).Color"
                                                        Storyboard.TargetName="PART_FormulaTextBox"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Normal" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ErrorStates">
                                <VisualState x:Name="Error">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="EditorArea" Storyboard.TargetProperty="BorderBrush">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource SyntaxEditorValidationErrorBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SyntaxErrorArea" Storyboard.TargetProperty="Background">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource SyntaxErrorBackgroundBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="NoError" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Grid.ColumnSpan="3" Margin="5">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Border Grid.ColumnSpan="3" Grid.RowSpan="2" BorderBrush="{StaticResource EditorAreaBorderBrush}" Background="{StaticResource EditorAreaBackgroundBrush}" BorderThickness="1" Name="EditorArea" CornerRadius="2,2,0,0">
                                    <StackPanel>
                                        <Border BorderThickness="0,0,0,1" BorderBrush="{StaticResource HeaderTitleBorderBrush}" Height="25" CornerRadius="2,2,0,0" Background="{StaticResource HeaderTitleBackgroundBrush}" >
                                            <Grid>

                                                <TextBlock Name="EditingAreaLabel" Style="{StaticResource LabelsStyle}" Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=LocalizedStrings[EditingAreaLabel], Mode=OneWay}"/>
                                                <StackPanel HorizontalAlignment="Right" Margin="0,0,10,0" Orientation="Horizontal" VerticalAlignment="Center" >
                                                    <Button  Name="UndoButton"
                                                            Command="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=UndoCommand, Mode=OneWay}"
                                                             Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=UndoRedoButtonVisibility, Mode=OneWay}" Style="{StaticResource TransparentBackgroundButtonStyle}" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0,2">
                                                        <Viewbox Width="14" Height="14" d:LayoutOverrides="Margin" RenderTransformOrigin="0.5,0.5">
                                                            <Grid Height="47" Width="47">
                                                                <Path Fill="{StaticResource UndoRedoShadowGlyphBrush}" Data="F1 M 5.713,23.849 C 6.210,13.897 14.587,7.705 23.488,7.705 C 27.306,7.705 30.809,9.046 33.573,11.274 L 25.570,18.195 L 46.650,21.308 L 46.609,0.000 L 39.207,6.402 C 35.043,2.649 29.535,0.359 23.488,0.359 C 10.517,0.359 0.000,10.877 0.000,23.849 C 0.000,36.821 10.517,47.338 23.488,47.338 C 9.928,43.028 5.269,32.740 5.713,23.849 Z" RenderTransformOrigin="0.5,0.5" UseLayoutRounding="False" d:LayoutOverrides="Width, Height" Margin="0,2.157,0,-2.172">
                                                                    <Path.RenderTransform>
                                                                        <ScaleTransform ScaleX="-1"/>
                                                                    </Path.RenderTransform>
                                                                </Path>
                                                                <Path Fill="{StaticResource UndoRedoGlyphBrush}" Data="F1 M 5.713,23.849 C 6.210,13.897 14.587,7.705 23.488,7.705 C 27.306,7.705 30.809,9.046 33.573,11.274 L 25.570,18.195 L 46.650,21.308 L 46.609,0.000 L 39.207,6.402 C 35.043,2.649 29.535,0.359 23.488,0.359 C 10.517,0.359 0.000,10.877 0.000,23.849 C 0.000,36.821 10.517,47.338 23.488,47.338 C 9.928,43.028 5.269,32.740 5.713,23.849 Z" RenderTransformOrigin="0.5,0.5" UseLayoutRounding="False" d:LayoutOverrides="Width, Height">
                                                                    <Path.RenderTransform>
                                                                        <ScaleTransform ScaleX="-1"/>
                                                                    </Path.RenderTransform>
                                                                </Path>
                                                            </Grid>
                                                        </Viewbox>
                                                    </Button>
                                                    <Button
                                                            Name="RedoButton"
                                                            Command="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=RedoCommand, Mode=OneWay}"
                                                            Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=UndoRedoButtonVisibility, Mode=OneWay}"
						                                     Style="{StaticResource TransparentBackgroundButtonStyle}" Width="20" Margin="5,0,0,0" VerticalAlignment="Center" Height="20" >
                                                        <Viewbox Width="14" Height="14" Margin="0,2">
                                                            <Grid Height="47" Width="47">
                                                                <Path Fill="{StaticResource UndoRedoShadowGlyphBrush}" Data="F1 M 5.713,23.849 C 6.210,13.897 14.587,7.705 23.488,7.705 C 27.306,7.705 30.809,9.046 33.573,11.274 L 25.570,18.195 L 46.650,21.308 L 46.609,0.000 L 39.207,6.402 C 35.043,2.649 29.535,0.359 23.488,0.359 C 10.517,0.359 0.000,10.877 0.000,23.849 C 0.000,36.821 10.517,47.338 23.488,47.338 C 9.928,43.028 5.269,32.740 5.713,23.849 Z" UseLayoutRounding="False" d:LayoutOverrides="Width, Height" Margin="0,2.5,0,-2.5"/>
                                                                <Path Fill="{StaticResource UndoRedoGlyphBrush}" Data="F1 M 5.713,23.849 C 6.210,13.897 14.587,7.705 23.488,7.705 C 27.306,7.705 30.809,9.046 33.573,11.274 L 25.570,18.195 L 46.650,21.308 L 46.609,0.000 L 39.207,6.402 C 35.043,2.649 29.535,0.359 23.488,0.359 C 10.517,0.359 0.000,10.877 0.000,23.849 C 0.000,36.821 10.517,47.338 23.488,47.338 C 9.928,43.028 5.269,32.740 5.713,23.849 Z" UseLayoutRounding="False" d:LayoutOverrides="Width, Height"/>
                                                            </Grid>
                                                        </Viewbox>
                                                    </Button>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                        <Grid>
                                            <igPrim:ContextualHelpHost Name="PART_ContextualHelpHost" />
                                            <igPrim:FormulaEditorTextBox Name="PART_FormulaTextBox"
                                                                            Height="100"
                                                                            IsReadOnly="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IsEditable, Converter={StaticResource inverseBoolean}}"
                                                                            IsUndoEnabled="False"
                                                                            Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Formula, Mode=TwoWay}"
									                                        Margin="5" Style="{StaticResource FormulaEditorTextBoxStyle}"/>
                                        </Grid>
                                        <Border Name="SyntaxErrorArea"
                                                MinHeight="20">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <RichTextBox Name="SyntaxErrorLabel"
                                                            Margin="5,0,0,0"
                                                            Background="{StaticResource TransparentBrush}"
                                                            BorderThickness="0"
                                                            IsReadOnly="True"
                                                            igPrim:SyntaxErrorInfo.DisplayedError="{Binding Path=CurrentSyntaxErrorInfo, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}"
                                                            VerticalAlignment="Center"
                                                            Visibility="{Binding Path=HasSyntaxError, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ResourceKey=boolToVisibility}, Mode=OneWay}" />
                                                <StackPanel Grid.Column="1"
                                                            Orientation="Horizontal" Margin="0,5"
                                                            Visibility="{Binding Path=HasMultipleSyntaxErrors, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ResourceKey=boolToVisibility}, Mode=OneWay}" >
                                                    <TextBlock  Name="MultipleSyntaxErrorsLabel"
                                                                Text="{Binding Path=MultipleSyntaxErrorsLabel, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}"
                                                                Margin="0,0,10,0"
                                                                VerticalAlignment="Center"/>
                                                    <Button Name="PreviousSyntaxErrorButton"
                                                            Command="{Binding Path=PreviousSyntaxErrorCommand, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}" BorderBrush="{StaticResource TransparentBrush}" Style="{StaticResource ButtonStyle}" >
                                                        <Viewbox Width="14" Height="14" d:LayoutOverrides="Margin">
                                                            <Grid Height="47" Width="47">
                                                                <Path Data="M18,0 L0,13 L18,26 z" Fill="{StaticResource ThemeLightForegroundBrush}" Height="26" Stretch="Fill" VerticalAlignment="Center" UseLayoutRounding="False" Width="18" HorizontalAlignment="Center" Margin="0,0,3,0" />
                                                            </Grid>
                                                        </Viewbox>
                                                    </Button>
                                                    <Button Name="NextSyntaxErrorButton"
                                                          	Command="{Binding Path=NextSyntaxErrorCommand, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}"
                                                            Margin="5,0,10,0" BorderBrush="{StaticResource TransparentBrush}" Style="{StaticResource ButtonStyle}">
                                                        <Viewbox Width="14" Height="14" Margin="0,2">
                                                            <Grid Height="47" Width="47">
                                                                <Path Data="M0,0 L18,13 L0,26 z" Fill="{StaticResource ThemeLightForegroundBrush}" Height="26" Stretch="Fill" VerticalAlignment="Center" UseLayoutRounding="False" Width="18" HorizontalAlignment="Center" Margin="3,0,0,0" />
                                                            </Grid>
                                                        </Viewbox>
                                                    </Button>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </StackPanel>
                                </Border>
                            </Grid>
                            <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                                <Button Name="ClearButton" Height="22"
                                        Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=LocalizedStrings[ClearButton], Mode=OneWay}"
                                        Command="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ClearCommand, Mode=OneWay}"
					                    MinWidth="40" Style="{StaticResource ButtonStyle}"/>
                                <StackPanel Orientation="Horizontal">
                                    <Button Name="InsertOperatorAddButton" Margin="{StaticResource OperandsButtonGroupMargin}"
                                            DataContext="{Binding Path=Operators[Operator_Add], RelativeSource={RelativeSource TemplatedParent}}"
                                            CommandParameter="{Binding}"
                                            Content="{Binding DisplayText}"
                                            Style="{StaticResource OperatorsButtonStyle}"/>
                                    <Button Name="InsertOperatorSubtractButton"
                                            DataContext="{Binding Path=Operators[Operator_Subtract], RelativeSource={RelativeSource TemplatedParent}}"
                                            CommandParameter="{Binding}"
                                            Content="{Binding DisplayText}"
                                            Style="{StaticResource OperatorsButtonStyle}"/>
                                    <Button Name="InsertOperatorMultiplyButton"
                                            DataContext="{Binding Path=Operators[Operator_Multiply], RelativeSource={RelativeSource TemplatedParent}}"
                                            CommandParameter="{Binding}"
                                            Content="{Binding DisplayText}"
                                            Style="{StaticResource OperatorsButtonStyle}"/>
                                    <Button Name="InsertOperatorDivideButton"
                                            DataContext="{Binding Path=Operators[Operator_Divide], RelativeSource={RelativeSource TemplatedParent}}"
                                            CommandParameter="{Binding}"
                                            Content="{Binding DisplayText}"
                                            Style="{StaticResource OperatorsButtonStyle}"/>
                                    <Button Name="InsertOperatorPowerButton"
                                            DataContext="{Binding Path=Operators[Operator_Power], RelativeSource={RelativeSource TemplatedParent}}"
                                            CommandParameter="{Binding}"
                                            Content="{Binding DisplayText}" Margin="{StaticResource OperandsButtonGroupMargin}"
                                            Style="{StaticResource OperatorsButtonStyle}"/>
                                    <Button Name="InsertOperatorPercentButton"
                                            DataContext="{Binding Path=Operators[Operator_Percent], RelativeSource={RelativeSource TemplatedParent}}"
                                            CommandParameter="{Binding}"
                                            Content="{Binding DisplayText}"
                                            Style="{StaticResource OperatorsButtonStyle}"/>
                                    <Button Name="InsertOperatorGreaterThanButton"
                                            DataContext="{Binding Path=Operators[Operator_GreaterThan], RelativeSource={RelativeSource TemplatedParent}}"
                                            CommandParameter="{Binding}"
                                            Content="{Binding DisplayText}" Margin="{StaticResource OperandsButtonGroupMargin}"
                                            Style="{StaticResource OperatorsButtonStyle}"/>
                                    <Button Name="InsertOperatorLessThanButton"
                                            DataContext="{Binding Path=Operators[Operator_LessThan], RelativeSource={RelativeSource TemplatedParent}}"
                                            CommandParameter="{Binding}"
                                            Content="{Binding DisplayText}"
                                            Style="{StaticResource OperatorsButtonStyle}"/>
                                    <Button Name="InsertOperatorEqualButton"
                                            DataContext="{Binding Path=Operators[Operator_Equal], RelativeSource={RelativeSource TemplatedParent}}"
                                            CommandParameter="{Binding}"
                                            Content="{Binding DisplayText}"
                                            Style="{StaticResource OperatorsButtonStyle}"/>
                                    <Button Name="InsertOperatorNotEqualButton"
                                            DataContext="{Binding Path=Operators[Operator_NotEqual], RelativeSource={RelativeSource TemplatedParent}}"
                                            CommandParameter="{Binding}"
                                            Content="{Binding DisplayText}"
                                            Style="{StaticResource OperatorsButtonStyle}"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                        <Grid Grid.Row="1" Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0" Margin="0,5,0,0" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <Border Grid.Row="1" Grid.ColumnSpan="2" BorderThickness="1" >
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Border x:Name="OperandsBd" Grid.Column="0" Margin="0,0,5,0" Padding="0,0,0,5" BorderBrush="{StaticResource HeaderTitleBorderBrush}" BorderThickness="1" Background="{StaticResource FormulaEditorDialogBackgroundBrush}" CornerRadius="2,2,0,0">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="*" />
                                                </Grid.RowDefinitions>
                                                <Border x:Name="bgOperandsLabel" BorderThickness="0,0,0,1" BorderBrush="{StaticResource HeaderTitleBorderBrush}" Height="25" Margin="0" CornerRadius="2,2,0,0"  Background="{StaticResource HeaderTitleBackgroundBrush}">
                                                    <TextBlock x:Name="OperandTreeLabel" Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=LocalizedStrings[OperandTreeLabel], Mode=OneWay}" Style="{StaticResource LabelsStyle}"/>
                                                </Border>
                                                <Border Margin="5"
                            						    BorderThickness="0"
                            						    Padding="0" Grid.Row="1" CornerRadius="4" VerticalAlignment="Center">
                                                    <Grid Margin="0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                        </Grid.ColumnDefinitions>
                                                        <Border Margin="0"
                            								    BorderThickness="1"
															Background="{StaticResource TextBoxGradientBackgroundBrush}" 
                            								BorderBrush="{StaticResource TextBoxBorderBrush}"
                            								    Padding="0"
                            								CornerRadius="4" Grid.ColumnSpan="2" Height="22" VerticalAlignment="Bottom"/>
                                                        <igPrim:EmbeddedTextBox
																		    BorderThickness="0"
                                                                            Name="OperandSearchTextBox"
                                                                            igPrim:XamlHelper.UpdateBindingOnTextPropertyChanged="True"
                                                                            Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=OperandSearchText, Mode=TwoWay}"
                                                                            VerticalAlignment="Center"
									  					                    Margin="5,0,0,0" />
                                                        <ComboBox Grid.Column="1"
                                                                    Name="OperandSearchFilterComboBox"
                                                                    DisplayMemberPath="Description"
                                                                    ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=OperandSearchTypes}"
                                                                    SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=OperandSearchType, Mode=TwoWay}"
                                                                    SelectedValuePath="EnumValue"
							    							        Style="{StaticResource ComboBoxStyle}"
							    							        BorderThickness="1" Foreground="{StaticResource ThemeForegroundBrush}" />
                                                    </Grid>
                                                </Border>
                                                <Border Grid.Row="2" BorderThickness="1" Background="{StaticResource EditorAreaBackgroundBrush}" BorderBrush="{StaticResource EditorAreaBorderBrush}" Margin="5,0" CornerRadius="4,4,0,0">

                                                    <ig:XamDataTree Name="OperandTree"
                                                                    ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Operands}"
																	Background="{x:Null}"
																	Style="{StaticResource XamDataTreeStyle}">
                                                        <ig:Commanding.Command>
                                                            <igPrim:FormulaEditorCommandSource EventName="KeyDown"
                                                                                              CommandType="InsertOperand"
                                                                                              Key="Enter"
                                                                                              ParameterBinding="{Binding Path=SelectionSettings.SelectedNodes[0].Data, FallbackValue=null}"/>
                                                        </ig:Commanding.Command>
                                                        <ig:XamDataTree.GlobalNodeLayouts>
                                                            <ig:NodeLayout Key="operands"
                                                                            DisplayMemberPath="Name"
                                                                            IsEnabledMemberPath="IsEnabled"
                                                                            IsExpandedMemberPath="IsExpanded"
                                                                            TargetTypeName="OperandInfo">
                                                                <ig:NodeLayout.ItemTemplate>
                                                                    <DataTemplate>
                                                                        <igPrim:FormulaElementContentControl>
                                                                            <ig:Commanding.Command>
                                                                                <igPrim:FormulaEditorCommandSource EventName="MouseDoubleClick"
                                                                                                                    CommandType="InsertOperand"
                                                                                                                    ParameterBinding="{Binding Path=Data}"/>
                                                                            </ig:Commanding.Command>
                                                                            <StackPanel Orientation="Horizontal">
                                                                                <TextBlock Name="OperandNameLabel" Text="{Binding Path=Data.Name, Mode=OneWay}" />
                                                                                <Border Visibility="{Binding Path=Data.IsDataReference, Converter={StaticResource boolToVisibility}, Mode=OneWay}">
                                                                                    <StackPanel Orientation="Horizontal"
                                                                                          Margin="10,0,0,0"
                                                                                          Visibility="{Binding Path=Node.IsActive, Converter={StaticResource boolToVisibility}, Mode=OneWay}">
                                                                                        <StackPanel.Resources>
                                                                                            <Style TargetType="TextBlock">
                                                                                                <Setter Property="Foreground" Value="{StaticResource OperandsForegroundBrush}"/>
                                                                                                <Setter Property="FontSize" Value="10"/>
                                                                                            </Style>
                                                                                        </StackPanel.Resources>
                                                                                        <TextBlock Name="OperandSignatureDescriptionLabel"
											                                                        FontStyle="Italic"
											                                                        Text="{Binding Path=Data.Dialog.LocalizedStrings[OperandSignatureLabel], Mode=OneWay}" />
                                                                                        <TextBlock Name="OperandSignatureLabel"
											                                                        Margin="5,0,0,0"
											                                                        FontWeight="Bold"
											                                                        Text="{Binding Path=Data.Signature, Mode=OneWay}" />
                                                                                    </StackPanel>
                                                                                </Border>
                                                                            </StackPanel>
                                                                        </igPrim:FormulaElementContentControl>
                                                                    </DataTemplate>
                                                                </ig:NodeLayout.ItemTemplate>
                                                            </ig:NodeLayout>
                                                        </ig:XamDataTree.GlobalNodeLayouts>
                                                    </ig:XamDataTree>
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Grid.Column="1"
						                        x:Name="FunctionsBd"
						                        Margin="5,0,0,0"
						                        Padding="0"
						                        BorderBrush="{StaticResource HeaderTitleBorderBrush}"
						                        BorderThickness="1"
						                        Background="{StaticResource FormulaEditorDialogBackgroundBrush}"
						                        CornerRadius="2,2,0,0">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="*" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <Border x:Name="bgFuntionLabel"
												        BorderThickness="0,0,0,1"
						                                BorderBrush="{StaticResource HeaderTitleBorderBrush}"
												        Height="25"
												        Margin="0"
												        VerticalAlignment="Top"
												        d:LayoutOverrides="Height"
												        CornerRadius="2,2,0,0"
						                                Background="{StaticResource HeaderTitleBackgroundBrush}">

                                                    <TextBlock x:Name="FunctionTreeLabel"
                            							    Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=LocalizedStrings[FunctionTreeLabel], Mode=OneWay}"
                            							Style="{StaticResource LabelsStyle}"/>
                                                </Border>
                                                <Border Margin="5"
                                                        BorderThickness="0"
                                                        Padding="0" Grid.Row="1" VerticalAlignment="Center" >
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                        </Grid.ColumnDefinitions>
                                                        <Border Margin="0" BorderThickness="1" Background="{StaticResource TextBoxGradientBackgroundBrush}" BorderBrush="{StaticResource TextBoxBorderBrush}" CornerRadius="4" Padding="0" Grid.Row="1" Grid.ColumnSpan="2" Height="22" />
                                                        <igPrim:EmbeddedTextBox BorderThickness="0"
                                                                          Name="FunctionSearchTextBox"
                                                                          igPrim:XamlHelper.UpdateBindingOnTextPropertyChanged="True"
                                                                          Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=FunctionSearchText, Mode=TwoWay}"
                                                                          VerticalAlignment="Center" Margin="5,0,0,0"/>
                                                        <ComboBox   Grid.Column="1" 
                                                                    Name="FunctionSearchFilterComboBox"
                                                                    DisplayMemberPath="Description"
                                                                    ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=FunctionSearchTypes}"
                                                                    SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=FunctionSearchType, Mode=TwoWay}"
                                                                    SelectedValuePath="EnumValue" Style="{StaticResource ComboBoxStyle}" Foreground="{StaticResource ThemeForegroundBrush}"/>
                                                    </Grid>
                                                </Border>
                                                <Border Grid.Row="2"
														BorderThickness="1,1,1,0"
						                                BorderBrush="{StaticResource EditorAreaBorderBrush}"
						                                Background="{StaticResource EditorAreaBackgroundBrush}"
														Margin="5,0"
						                                CornerRadius="4,4,0,0">
                                                    <ig:XamDataTree Name="FunctionTree"
                                                                    ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=FunctionCategories}"
						    										Background="{x:Null}"
																	Style="{StaticResource XamDataTreeStyle}">
                                                        <ig:Commanding.Command>
                                                            <igPrim:FormulaEditorCommandSource  EventName="KeyDown"
                                                                                            CommandType="InsertFunction"
                                                                                            Key="Enter"
                                                                                            ParameterBinding="{Binding Path=SelectionSettings.SelectedNodes[0].Data, FallbackValue=null}"/>
                                                        </ig:Commanding.Command>
                                                        <ig:XamDataTree.GlobalNodeLayouts>
                                                            <ig:NodeLayout  Key="categories"
                                                                            TargetTypeName="FunctionCategory"
                                                                            IsExpandedMemberPath="IsExpanded">
                                                                <ig:NodeLayout.ItemTemplate>
                                                                    <DataTemplate>
                                                                        <TextBlock Name="CategoryNameLabel">
                                                                <TextBlock.Inlines>
                                                                    <Run Text="{Binding Path=Data.Name, Mode=OneWay}" />

                                                                    <Run Text="{Binding Path=Data.Functions.Count, Mode=OneWay, StringFormat='({0})'}" />
                                                                </TextBlock.Inlines>
                                                                        </TextBlock>
                                                                    </DataTemplate>
                                                                </ig:NodeLayout.ItemTemplate>
                                                            </ig:NodeLayout>
                                                            <ig:NodeLayout  Key="functions"
                                                                            TargetTypeName="FunctionInfo">
                                                                <ig:NodeLayout.ItemTemplate>
                                                                    <DataTemplate>
                                                                        <igPrim:FormulaElementContentControl>
                                                                            <ig:Commanding.Command>
                                                                                <igPrim:FormulaEditorCommandSource  EventName="MouseDoubleClick"
                                                                                                                CommandType="InsertFunction"
                                                                                                                ParameterBinding="{Binding Path=Data}"/>
                                                                            </ig:Commanding.Command>
                                                                            <StackPanel Orientation="Horizontal">
                                                                                <TextBlock Name="FunctionNameLabel"
                                                                                   Text="{Binding Path=Data.Name, Mode=OneWay}" />
                                                                                <StackPanel Orientation="Horizontal"
                                                                                            Margin="10,0,0,0"
                                                                                            Visibility="{Binding Path=Node.IsActive, Converter={StaticResource boolToVisibility}, Mode=OneWay}">
                                                                                    <StackPanel.Resources>
                                                                                        <Style TargetType="TextBlock">
                                                                                            <Setter Property="Foreground" Value="{StaticResource OperandsForegroundBrush}"/>
                                                                                            <Setter Property="FontSize" Value="10"/>
                                                                                        </Style>
                                                                                    </StackPanel.Resources>
                                                                                    <TextBlock  Name="FunctionSignatureDescriptionLabel"
                                                                                                FontStyle="Italic"
                                                                                                Text="{Binding Path=Data.Dialog.LocalizedStrings[FunctionSignatureLabel], Mode=OneWay}" />
                                                                                    <TextBlock  Name="FunctionSignatureLabelNamePortion"
                                                                                                Margin="5,0,0,0"
                                                                                                FontWeight="Bold"
                                                                                                Text="{Binding Path=Data.Name, Mode=OneWay}" />
                                                                                    <TextBlock Name="FunctionSignatureLabelArgumentsPortion"
                                                                                                Text="{Binding Path=Data.Signature, Mode=OneWay}" />
                                                                                </StackPanel>
                                                                            </StackPanel>
                                                                        </igPrim:FormulaElementContentControl>
                                                                    </DataTemplate>
                                                                </ig:NodeLayout.ItemTemplate>
                                                            </ig:NodeLayout>
                                                        </ig:XamDataTree.GlobalNodeLayouts>
                                                    </ig:XamDataTree>
                                                </Border>
                                                <Border Grid.Row="3"
                                                        MinHeight="80"
                            						    MaxHeight="120"
                                                        BorderThickness="1"
														Background="{StaticResource DescriptionBackgroundBrush}" 
                                                        BorderBrush="{StaticResource DescriptionBorderBrush}"
                            			                Margin="5,0,5,5">
                                                    <TextBlock Name="SelectedFunctionDescription"
                                                               FontSize="10"
                                                               Padding="5"
                                                               TextWrapping="Wrap">
                                                     <TextBlock.Inlines>
                                                        <Run FontWeight="Bold"
                                                             Text="{Binding ElementName=FunctionTree, Path=SelectionSettings.SelectedNodes[0].Data.Name, Mode=OneWay, FallbackValue=''}" />
                                                        <LineBreak/>
                                                        <Run Text="{Binding ElementName=FunctionTree, Path=SelectionSettings.SelectedNodes[0].Data.Description, Mode=OneWay, FallbackValue=''}"/>
                                                    </TextBlock.Inlines>
                                                    </TextBlock>
                                                </Border>
                                            </Grid>
                                        </Border>
                                    </Grid>
                                </Border>
                            </Grid>
                            <StackPanel Grid.Row="1"
                                        Margin="5,10"
                                        Orientation="Horizontal"
                                        HorizontalAlignment="Right"
                                        Visibility="{Binding Path=ShowDialogButtons, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ResourceKey=boolToVisibility}, Mode=OneWay}" >
                                <Button Name="OKButton"
                                        Margin="5"
                                        MinWidth="100"
                                        Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=LocalizedStrings[OKButton], Mode=OneWay}"
                                        Command="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=CommitCommand, Mode=OneWay}"
					Style="{StaticResource ButtonStyle}" />
                                <Button Name="CancelButton"
                                        Margin="5"
                                        MinWidth="100"
                                        Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=LocalizedStrings[CancelButton], Mode=OneWay}"
                                        Command="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=CancelCommand, Mode=OneWay}"
					Style="{StaticResource ButtonStyle}" />
                            </StackPanel>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="ig:FormulaEditorDialog" BasedOn="{StaticResource FormulaEditorDialogStyle}"/>

    <!-- *********************************  XamFormulaEditor Style  ********************************* -->
    <Style x:Key="XamFormulaEditorStyle" TargetType="ig:XamFormulaEditor">
        <Setter Property="Background" Value="{StaticResource FormulaEditorBackgroundBrush}"/>
        <Setter Property="BorderBrush" Value="{StaticResource FormulaEditorBorderBrush}"/>
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="igPrim:XamlHelper.Focusable" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ig:XamFormulaEditor">
                    <Border Name="EditorArea"
                            Background="{TemplateBinding Background}" 
                            BorderBrush="{TemplateBinding BorderBrush}" 
                            BorderThickness="1"
                		    MinHeight="23"
                		    Height="26"
                		    Padding="1">
                        <Border.Resources>
                            <Style TargetType="ScrollBar" BasedOn="{StaticResource ScrollbarStyle}" />
                        </Border.Resources>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                		<DoubleAnimation Duration="0" To="0.55" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="DisabledVisualElement" d:IsOptimized="True"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Normal" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ErrorStates">
                                <VisualState x:Name="Error">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="EditorAreaBg" Storyboard.TargetProperty="BorderBrush">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource SyntaxEditorValidationErrorBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="NoError" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid Margin="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Border BorderThickness="1" x:Name="EditorAreaBg" Background="{StaticResource TextBoxGradientBackgroundBrush}" BorderBrush="{StaticResource EditorAreaBorderBrush}" Grid.ColumnSpan="2" CornerRadius="3">
                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroup x:Name="ErrorStates1">
                                        <VisualState x:Name="Error1"/>
                                        <VisualState x:Name="NoError1" />
                                    </VisualStateGroup>
                                </VisualStateManager.VisualStateGroups>
                                <Grid HorizontalAlignment="Right" Margin="0" Width="22" Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=HasSyntaxError, Converter={StaticResource boolToVisibility}}">
                                    <Border CornerRadius="0,2,2,0" BorderThickness="1,0,0,0" Margin="2,0,0,0" Background="{StaticResource SyntaxEditorValidationErrorBrush}" Name="PART_ErrorIndicator">
                                        <Path Data="M17.978895,14.4374 L14.459287,17.981174 L9.5024157,13.021268 L4.5621309,17.986851 L1.0009997,14.46541 L5.96099,9.4979582 L1.0248781,4.5379386 L4.544733,1.0159005 L9.5026722,5.9762726 L14.459279,0.99506438 L17.999273,4.5379333 L13.063161,9.5396385 z"
										Margin="3" Width="10" Height="10" RenderTransformOrigin="0.5,0.5" Stretch="Fill" UseLayoutRounding="False" Fill="{StaticResource FunctionGlyphBackgroundBrush}">
                                            <Path.RenderTransform>
                                                <TransformGroup>
                                                    <ScaleTransform/>
                                                    <SkewTransform/>
                                                    <RotateTransform/>
                                                    <TranslateTransform/>
                                                </TransformGroup>
                                            </Path.RenderTransform>
                                        </Path>
                                        <ToolTipService.ToolTip>
                                            <ToolTip Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SyntaxError}" Background="{StaticResource SyntaxErrorBackgroundBrush}"/>
                                        </ToolTipService.ToolTip>
                                    </Border>
                                </Grid>
                            </Border>
                            <Border x:Name="DisabledVisualElement"  Background="{StaticResource ThemeLightForegroundBrush}" IsHitTestVisible="False" CornerRadius="3" Opacity="0" Grid.ColumnSpan="2"/>
                            <Button Name="ShowDialogButton"  Width="30" Margin="0" Style="{StaticResource ButtonStyle}" IsTabStop="False" igPrim:XamlHelper.Focusable="False"
                                    ToolTipService.ToolTip="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=LocalizedStrings[ShowDialogButtonToolTip]}">
                                <ig:Commanding.Command>
                                    <igPrim:FormulaEditorCommandSource EventName="Click" CommandType="DisplayDialog" />
                                </ig:Commanding.Command>
                                <Viewbox Height="14" Width="14">
                                    <Grid Height="18.0019998550415" Width="17.4860000610352">
                                        <Path Data="M9.3881884,1.7934027 C9.8022442,1.7934036 10.124512,1.8826046 10.354992,2.0610056 C10.585472,2.2394085 10.700712,2.4570704 10.700712,2.7139921 C10.700712,2.9476528 10.61837,3.1427889 10.453688,3.2994003 C10.289005,3.4560127 10.076303,3.5343189 9.8155842,3.5343189 C9.5847721,3.5343189 9.1698141,3.4695663 8.5707092,3.3400612 C8.2877722,3.2811947 8.0728636,3.2517614 7.9259839,3.2517614 C7.5940552,3.2517614 7.2793589,3.480176 6.9818954,3.937006 C6.684432,4.393836 6.4401855,5.0364485 6.2491555,5.8648453 L5.7974057,7.5812664 L8.2123861,7.5812664 L8.0290947,8.5930023 L5.5802183,8.5930023 L4.1868014,14.27149 C3.7354317,16.070417 3.0059433,17.440739 1.9983369,18.382454 C0.99073017,19.324169 -0.10985169,19.795025 -1.3034085,19.795025 C-1.7300926,19.795025 -2.061594,19.705944 -2.2979128,19.527779 C-2.5342317,19.349613 -2.6523912,19.11968 -2.6523912,18.837978 C-2.6523912,18.592449 -2.5644481,18.397385 -2.388562,18.252783 C-2.2126758,18.108181 -1.9755262,18.035879 -1.6771133,18.035879 C-1.5511209,18.035879 -1.3335063,18.054773 -1.0242695,18.092562 C-0.65588188,18.139845 -0.2779997,18.163486 0.10937687,18.163486 C0.6603443,18.163486 1.0570968,18.038181 1.2996345,17.787575 C1.5421723,17.536966 1.7965543,16.876312 2.0627809,15.805615 L3.9102261,8.5930023 L1.7318016,8.5930023 L1.9340352,7.5812664 L4.1107507,7.5812664 C4.4513187,6.1381941 4.8594885,5.034811 5.3352594,4.2711182 C5.8110304,3.5074263 6.4331355,2.9035501 7.2015753,2.4594908 C7.9700146,2.0154333 8.6988859,1.7934036 9.3881884,1.7934027 z" Margin="0,0,3.647,-0.002" RenderTransformOrigin="0.5,0.5" Stretch="Fill" UseLayoutRounding="False" Fill="{StaticResource FunctionGlyphBackgroundBrush}" />
                                        <Path Data="M10.697749,7.5212526 C10.986374,7.5212526 11.221722,7.6083822 11.403793,7.7826414 C11.585865,7.9569006 11.676901,8.1700592 11.676901,8.4221172 C11.676901,8.7074862 11.529496,8.9553127 11.234688,9.1655951 C11.102745,9.2605381 10.709034,9.3302517 10.053554,9.3747387 C9.5888252,9.4001293 9.1824732,9.5546408 8.8344975,9.838274 C8.2477007,10.323292 7.6847758,11.018323 7.1457219,11.923365 L7.805542,14.957985 C8.0879812,16.314844 8.3798332,17.311274 8.681098,17.947277 C8.9823627,18.583281 9.3448524,19.067513 9.7685652,19.399973 C9.9867687,19.570976 10.227054,19.656479 10.48942,19.656479 C10.837504,19.656479 11.095313,19.431223 11.262845,18.980709 C11.428749,18.535404 11.705654,18.31275 12.093561,18.31275 C12.298093,18.31275 12.472488,18.392096 12.616746,18.550783 C12.761003,18.709473 12.833132,18.900957 12.833133,19.125238 C12.833132,19.534628 12.616827,19.899124 12.184217,20.218727 C11.751606,20.538328 11.207506,20.69813 10.551919,20.69813 C9.8394737,20.69813 9.1634579,20.477024 8.5238743,20.034809 C7.8842897,19.592598 7.3381557,18.895641 6.8854718,17.943941 C6.4327879,16.992241 6.0468349,15.552702 5.7276125,13.625323 C5.7685184,13.777231 5.6442261,14.06043 5.3547339,14.47492 C4.4665098,15.729783 3.7693636,16.54425 3.2632954,16.918322 C2.7572269,17.292395 2.2597303,17.479429 1.7708058,17.479429 C1.4126298,17.479429 1.1112837,17.376133 0.86676699,17.169538 C0.62225044,16.962946 0.49999216,16.708609 0.49999222,16.40653 C0.49999216,16.158596 0.58573842,15.942101 0.757231,15.757045 C0.92872357,15.571989 1.1311672,15.479462 1.3645619,15.479462 C1.6159686,15.479462 1.8328706,15.597515 2.0152681,15.833622 C2.1798706,16.041952 2.2997687,16.146118 2.3749628,16.146118 C2.4398489,16.146118 2.5109742,16.12561 2.5883384,16.084595 C2.7431755,15.997899 2.9602401,15.801614 3.2395327,15.495737 C3.6541312,15.046526 4.0985689,14.634856 4.5728455,14.260731 L5.4374151,12.524267 L5.0135937,10.660526 C4.9083433,10.160751 4.8138895,9.8563395 4.7302322,9.7472916 C4.6465745,9.6382446 4.5698071,9.5837202 4.4999299,9.5837202 C4.4393835,9.5837202 4.3563228,9.6149702 4.2507472,9.6774693 C3.81499,9.9254036 3.3882391,10.203176 2.970494,10.510789 L2.4895444,9.8532467 C3.2880344,9.1333151 3.9661922,8.6250763 4.5240178,8.3285313 C4.9238596,8.1097851 5.2317972,8.000411 5.4478316,8.000411 C5.7940722,8.000411 6.0673966,8.1659908 6.2678056,8.4971485 C6.5140042,8.8999205 6.7196217,9.6857157 6.8846583,10.854534 C7.5597773,9.6338491 8.2420578,8.7731314 8.9315014,8.2723799 C9.6209431,7.7716284 10.209693,7.5212526 10.697749,7.5212526 z" Margin="8.486,7.541,-0.486,1.458" RenderTransformOrigin="0.459,0.441" Stretch="Fill" UseLayoutRounding="False" Height="8" d:LayoutOverrides="VerticalAlignment" Width="8" Fill="{StaticResource FunctionGlyphBackgroundBrush}" />
                                    </Grid>
                                </Viewbox>
                            </Button>
                            <igPrim:ContextualHelpHost Grid.Column="1" Name="PART_ContextualHelpHost" Margin="2,0" FontSize="12" />
                            <igPrim:FormulaEditorTextBox Grid.Column="1" 
                                                         Name="PART_FormulaTextBox" 
                                                         Background="{x:Null}" 
                                                         AcceptsReturn="False" 
                                                         MinLineCount="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=MinLineCount, Mode=OneWay}" 
                                                         MaxLineCount="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=MaxLineCount, Mode=OneWay}" 
                                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Formula, Mode=TwoWay}"
                                                         IsReadOnly="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IsEditable, Converter={StaticResource inverseBoolean}}"
                                                         IsUndoEnabled="False" 
                                                         Margin="10,0,18,0" 
                                                         VerticalAlignment="Center" 
                                                         Style="{StaticResource FormulaEditorTextBoxStyle}"/>

                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="ig:XamFormulaEditor" BasedOn="{StaticResource XamFormulaEditorStyle}"/>

</ResourceDictionary>